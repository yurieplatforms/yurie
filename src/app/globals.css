@import 'tailwindcss';
@plugin '@tailwindcss/typography';
@source "../node_modules/streamdown/dist/index.js";
@custom-variant dark (&:is(.dark *));

/* Utility class for Zalando Sans font (logo) */
.font-zalando {
  font-family: 'Zalando Sans Expanded', sans-serif;
  font-weight: 600;
  font-style: italic;
}

/*
  The default border color has changed to `currentColor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-gray-200, currentColor);
  }
}

@layer base {
  html {
    overflow-y: auto;
  }

  /* Home page: no scrolling at any viewport size */
  html:has([data-page="home"]) {
    overflow: hidden;
  }

  body:has([data-page="home"]) {
    overflow: hidden;
  }
}

@layer base {
  :root {
    /* Core Colors - Clean & Minimal */
    --color-background: rgb(255 255 255 / 1);
    --color-foreground: rgb(9 9 11 / 1);
    --color-muted: rgb(250 250 250 / 1);
    --color-muted-foreground: rgb(113 113 122 / 1);
    --color-accent: #7F91E0;
    --color-accent-foreground: #ffffff;
    --color-accent-hover: #6B7FD6;
    
    /* Surface colors for cards, panels, etc. */
    --color-surface: rgb(250 250 250 / 0.8);
    --color-surface-hover: rgb(244 244 245 / 1);
    --color-surface-active: rgb(228 228 231 / 1);
    --color-surface-elevated: rgb(255 255 255 / 1);
    --color-border: rgb(228 228 231 / 0.8);
    --color-border-subtle: rgb(244 244 245 / 1);
    
    /* Semantic Colors */
    --color-success: #10b981;
    --color-success-foreground: #ffffff;
    --color-warning: #f59e0b;
    --color-warning-foreground: #ffffff;
    --color-destructive: #ef4444;
    --color-destructive-foreground: #ffffff;
    --color-info: #8b5cf6;
    --color-info-foreground: #ffffff;
    
    /* Unified Design Tokens */
    --color-surface-dark: #202020;
    --color-prompt-bg: #1F2023;
    --color-prompt-dark-bg: #181818;

    /* Profile Gradients */
    --color-gradient-mid-1: #9683D8;
    --color-gradient-mid-2: #D4A5C9;
    
    --radius-sm: 0.5rem;
    --radius-md: 0.75rem;
    --radius-lg: 1rem;
    --radius-xl: 1.25rem;
    --radius-2xl: 1.5rem;
    --radius-full: 9999px;
    --radius-input: 9999px;
    --radius-card: 1rem;
    --radius-dialog: 1.5rem;
    --radius-prompt: 1.625rem;
    
    /* Shadows - Softer & Cleaner */
    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.03);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.05);
    --shadow-lg: 0 8px 30px rgba(0, 0, 0, 0.08);
    --shadow-accent: 0 4px 14px rgba(127, 145, 224, 0.25);
    --shadow-destructive: 0 4px 14px rgba(239, 68, 68, 0.2);
    
    /* Spacing */
    --space-input-x: 1rem;
    --space-input-y: 0.625rem;
    --space-card: 1rem;
    --space-section: 1.5rem;
    
    /* Transitions */
    --transition-fast: 150ms ease;
    --transition-base: 200ms ease;
    --transition-slow: 300ms ease;
  }

  .dark {
    /* Core Colors */
    --color-background: rgb(0 0 0 / 1);
    --color-foreground: rgb(250 250 250 / 1);
    --color-muted: rgb(39 39 42 / 1);
    --color-muted-foreground: rgb(161 161 170 / 1);
    --color-accent: #7F91E0;
    --color-accent-foreground: #ffffff;
    --color-accent-hover: #8FA0E8;
    
    /* Profile Gradients Dark */
    --color-gradient-mid-1: #5F5088;
    --color-gradient-mid-2: #876878;
    --color-gradient-dark-start: #4A5A9E;
    
    /* Surface colors for cards, panels, etc. */
    --color-surface: rgb(24 24 27 / 0.6);
    --color-surface-hover: rgb(39 39 42 / 1);
    --color-surface-active: rgb(52 52 56 / 1);
    --color-surface-elevated: rgb(24 24 27 / 1);
    --color-border: rgb(39 39 42 / 0.5);
    --color-border-subtle: rgb(39 39 42 / 0.3);
    
    /* Semantic Colors */
    --color-success: #34d399;
    --color-success-foreground: #ffffff;
    --color-warning: #fbbf24;
    --color-warning-foreground: #ffffff;
    --color-destructive: #f87171;
    --color-destructive-foreground: #ffffff;
    --color-info: #a78bfa;
    --color-info-foreground: #ffffff;
    
    /* Shadows - darker for dark mode */
    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.2);
    --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 8px 30px rgba(0, 0, 0, 0.4);
    --shadow-accent: 0 4px 14px rgba(127, 145, 224, 0.15);
    --shadow-destructive: 0 4px 14px rgba(248, 113, 113, 0.15);

    /* Syntax Highlighting (Dark Mode) - Colorful pastels */
    --sh-class: #7ec8e8;
    --sh-sign: #c8d0d8;
    --sh-string: #98d89c;
    --sh-keyword: #e89cbc;
    --sh-comment: #8888a0;
    --sh-jsxliterals: #7ec8e8;
    --sh-property: #6cd8c8;
    --sh-entity: #e8c878;
  }
}

:root {
  --sh-class: #7aa2f7;
  --sh-sign: #89ddff;
  --sh-string: #9ece6a;
  --sh-keyword: #bb9af7;
  --sh-comment: #565f89;
  --sh-jsxliterals: #7aa2f7;
  --sh-property: #73daca;
  --sh-entity: #e0af68;
}

@layer utilities {
  /* Remove outer border from Streamdown-rendered tables (chat tables, markdown, etc.) */
  [data-streamdown="table"] {
    border-width: 0 !important;
  }

  /* Match table separator lines to PromptInput outline color */
  [data-streamdown="table"] thead,
  [data-streamdown="table"] tbody,
  [data-streamdown="table"] tr,
  [data-streamdown="table"] th,
  [data-streamdown="table"] td {
    border-color: rgb(212 212 216 / 1); /* zinc-300 */
  }

  .dark [data-streamdown="table"] thead,
  .dark [data-streamdown="table"] tbody,
  .dark [data-streamdown="table"] tr,
  .dark [data-streamdown="table"] th,
  .dark [data-streamdown="table"] td {
    border-color: rgb(39 39 42 / 1); /* zinc-800 */
  }

  /* Remove outer border from Streamdown-rendered code blocks */
  [data-streamdown="code-block"],
  [data-code-block-container="true"],
  [data-code-block-container] {
    border-width: 0 !important;
  }

  /* Match code block border + background colors to user chat bubble */
  [data-streamdown="code-block"],
  [data-code-block-container="true"],
  [data-code-block-container] {
    background-color: rgb(244 244 245 / 0.9) !important; /* match user bubble bg-zinc-100/90 */
  }

  .dark [data-streamdown="code-block"],
  .dark [data-code-block-container="true"],
  .dark [data-code-block-container] {
    background-color: rgb(24 24 27 / 1) !important; /* match user bubble dark:bg-zinc-900 */
  }

  /* Inner code area border + background */
  [data-streamdown="code-block-body"],
  [data-code-block] {
    border-top-width: 0 !important; /* remove separator line under header */
    border-color: rgb(212 212 216 / 1); /* zinc-300 */
    background-color: rgb(244 244 245 / 0.9) !important; /* match user bubble bg-zinc-100/90 */
  }

  .dark [data-streamdown="code-block-body"],
  .dark [data-code-block] {
    border-color: rgb(39 39 42 / 1); /* zinc-800 */
    background-color: rgb(24 24 27 / 1) !important; /* match user bubble dark:bg-zinc-900 */
  }

  /* Remove extra space between header and code, and force unified background */
  [data-streamdown="code-block-body"] pre,
  [data-streamdown="code-block-body"] pre code,
  [data-streamdown="code-block"] pre,
  [data-streamdown="code-block"] pre code,
  [data-code-block] pre,
  [data-code-block] pre code {
    margin-top: 0;
    margin-bottom: 0;
    background-color: rgb(244 244 245 / 0.9) !important; /* override Shiki inline bg */
  }

  .dark [data-streamdown="code-block-body"] pre,
  .dark [data-streamdown="code-block-body"] pre code,
  .dark [data-streamdown="code-block"] pre,
  .dark [data-streamdown="code-block"] pre code,
  .dark [data-code-block] pre,
  .dark [data-code-block] pre code {
    background-color: rgb(24 24 27 / 1) !important; /* override Shiki inline bg */
  }

  /* Code block header surface + text (match code background) */
  [data-streamdown="code-block-header"],
  [data-code-block-header] {
    background-color: rgb(244 244 245 / 0.9) !important;
    color: rgb(24 24 27 / 1); /* zinc-900 */
    border-bottom: 1px solid rgb(228 228 231 / 1); /* zinc-200 */
  }

  .dark [data-streamdown="code-block-header"],
  .dark [data-code-block-header] {
    background-color: rgb(24 24 27 / 1) !important;
    color: rgb(228 228 231 / 1); /* zinc-200 */
    border-bottom: 1px solid rgb(39 39 42 / 1); /* zinc-800, subtle separator */
  }

  /* Code block line numbers - match placeholder text color (muted-foreground) */
  [data-streamdown="code-block-body"] code > span::before,
  [data-streamdown="code-block"] code > span::before {
    color: var(--color-muted-foreground) !important;
    opacity: 1 !important;
  }

  /* Dark mode code block text - enhance readability */
  .dark [data-streamdown="code-block-body"] pre code,
  .dark [data-streamdown="code-block"] pre code,
  .dark [data-code-block] pre code,
  .dark pre code,
  .dark pre.shiki code {
    /* Ensure base text is bright white */
    color: #ffffff !important;
  }

  /* Override ALL Shiki token colors in dark mode - colorful and bright */
  .dark [data-streamdown="code-block-body"] pre code span,
  .dark [data-streamdown="code-block"] pre code span,
  .dark [data-code-block] pre code span,
  .dark pre code span,
  .dark pre.shiki code span,
  .dark pre.shiki span {
    /* High brightness with good saturation for colorful look */
    filter: brightness(1.6) saturate(1.1);
  }

  /* Force colorful bright colors on Shiki spans with inline styles */
  .dark pre.shiki span[style],
  .dark [data-streamdown] pre span[style],
  .dark code span[style] {
    filter: brightness(1.6) saturate(1.1) !important;
  }

  /* Specific token color overrides for dark mode - colorful */
  .dark pre code .token.comment,
  .dark pre code .token.prolog,
  .dark pre code .token.doctype,
  .dark pre code .token.cdata {
    color: #8888a0 !important; /* muted lavender gray */
  }

  .dark pre code .token.punctuation {
    color: #b8c0c8 !important; /* silver */
  }

  .dark pre code .token.property,
  .dark pre code .token.tag,
  .dark pre code .token.constant,
  .dark pre code .token.symbol,
  .dark pre code .token.deleted {
    color: #f0a0b8 !important; /* pink */
  }

  .dark pre code .token.boolean,
  .dark pre code .token.number {
    color: #f0c080 !important; /* orange */
  }

  .dark pre code .token.selector,
  .dark pre code .token.attr-name,
  .dark pre code .token.string,
  .dark pre code .token.char,
  .dark pre code .token.builtin,
  .dark pre code .token.inserted {
    color: #90d898 !important; /* green */
  }

  .dark pre code .token.operator,
  .dark pre code .token.entity,
  .dark pre code .token.url,
  .dark pre code .token.variable {
    color: #70d8c8 !important; /* teal */
  }

  .dark pre code .token.atrule,
  .dark pre code .token.attr-value,
  .dark pre code .token.function,
  .dark pre code .token.class-name {
    color: #80c8f0 !important; /* blue */
  }

  .dark pre code .token.keyword {
    color: #e090b8 !important; /* magenta/rose */
  }

  .dark pre code .token.regex,
  .dark pre code .token.important {
    color: #f0d070 !important; /* yellow */
  }

  /* Match AI-generated horizontal rule separators to PromptInput outline color */
  [data-streamdown="horizontal-rule"] {
    border-color: rgb(212 212 216 / 1); /* zinc-300 */
  }

  .dark [data-streamdown="horizontal-rule"] {
    border-color: rgb(39 39 42 / 1); /* zinc-800 */
  }

  /* AI-generated links in prose content - use accent color */
  .prose a,
  .prose-gray a,
  [data-streamdown] a {
    color: var(--color-accent);
    text-decoration: underline;
    text-underline-offset: 2px;
    transition: color 0.15s ease;
  }

  .prose a:hover,
  .prose-gray a:hover,
  [data-streamdown] a:hover {
    color: var(--color-accent-hover);
  }

  .dark .prose a,
  .dark .prose-gray a,
  .dark [data-streamdown] a {
    color: var(--color-accent);
  }

  .dark .prose a:hover,
  .dark .prose-gray a:hover,
  .dark [data-streamdown] a:hover {
    color: var(--color-accent-hover);
  }

  /* KaTeX LaTeX math styling */
  .prose .katex {
    font-size: 1.3em !important;
  }

  .prose .katex-display {
    margin: 1.5rem 0;
    overflow-x: auto;
    overflow-y: hidden;
    padding: 0.75rem 0;
  }

  .prose .katex-display > .katex {
    text-align: center;
    font-size: 1.6em !important;
  }

  /* Math display blocks styling */
  .prose .math-display,
  [data-streamdown] .math-display {
    margin: 1.5rem 0;
    padding: 1rem;
    border-radius: 0.5rem;
    background-color: rgb(250 250 250 / 0.6);
    overflow-x: auto;
  }

  .dark .prose .math-display,
  .dark [data-streamdown] .math-display {
    background-color: rgb(24 24 27 / 0.4);
  }

  /* Inline math styling - subtle background for readability */
  .prose .math-inline,
  [data-streamdown] .math-inline {
    padding: 0.1em 0.2em;
    border-radius: 0.25rem;
  }

  /* PromptKit-style text loaders (text-blink, loading-dots) */
  .loader-text-blink {
    animation: loader-text-blink 1.1s ease-in-out infinite;
  }

  @keyframes loader-text-blink {
    0%,
    100% {
      opacity: 0.3;
    }
    50% {
      opacity: 1;
    }
  }

  .loader-loading-dots::after {
    content: '...';
    display: inline-block;
    width: 1.5em;
    text-align: left;
    animation: loader-loading-dots 1.4s steps(4, end) infinite;
  }

  @keyframes loader-loading-dots {
    0% {
      content: '';
    }
    25% {
      content: '.';
    }
    50% {
      content: '..';
    }
    75%,
    100% {
      content: '...';
    }
  }
}
